<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carrito de Compras - Recirculate</title>
<link rel="stylesheet" href="../assets/public-styles.css">
<link rel="stylesheet" href="carrito.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

  <header class="public-header fixed-header">
    <nav class="header-nav">
      <div class="header-left">
        <button id="menu-btn" class="header-icon menu-icon"><i class="fas fa-bars"></i></button>
        <div id="search-container" class="search-container">
          <button id="search-btn" class="header-icon search-icon"><i class="fas fa-search"></i></button>
          <input type="text" id="search-input" class="search-input" placeholder="Buscar...">
        </div>
      </div>
      <a href="../home/home.html" class="header-logo">
        <img src="../assets/images/Recirculate-logo.png" alt="Recirculate Logo" class="logo-image">
      </a>
      <div class="header-right">
        <a href="#" class="header-icon user-icon" id="user-menu-trigger" data-tooltip="INICIAR SESIÓN">
          <i class="fas fa-user"></i>
        </a>
        <a href="./carrito.html" class="header-icon cart-icon">
          <i class="fas fa-shopping-cart"></i>
          <span id="cart-counter" class="cart-counter">0</span>
        </a>
      </div>
    </nav>
  </header>

<div id="sidebar-menu" class="sidebar">
  <button id="close-btn" class="close-btn">&times;</button>
  
  <div class="sidebar-menu-list">
    <div class="sidebar-category" data-category="hombre">
      <div class="sidebar-category-header">
        <span>HOMBRE</span>
        <i class="fas fa-chevron-right toggle-icon"></i>
      </div>
      <div class="sidebar-submenu">
        <a href="../pages/hombre/hombre.html"><strong>Ver Todo Hombre</strong></a>
        <a href="../pages/remeras/remeras.html">Remeras</a>
        <a href="../pages/buzos/buzos.html">Buzos</a>
        <a href="../pages/camperas/camperas.html">Camperas</a>
        <a href="../pages/pantalones/pantalones.html">Pantalones</a>
        <a href="../pages/camisas/camisas.html">Camisas</a> 
      </div>
    </div>

    <div class="sidebar-category" data-category="mujer">
      <div class="sidebar-category-header">
        <span>MUJER</span>
        <i class="fas fa-chevron-right toggle-icon"></i>
      </div>
      <div class="sidebar-submenu">
        <a href="../pages/mujer/mujer.html"><strong>Ver Todo Mujer</strong></a>
        <a href="../pages/Mremeras/Mremeras.html">Remeras/Tops</a>
        <a href="../pages/Mvestidos/Mvestidos.html">Vestidos/Monos</a>
        <a href="../pages/Mpolleras/Mpolleras.html">Polleras/Shorts/Skorts</a>
      </div>
    </div>

    <a href="../pages/unisex/unisex.html" class="sidebar-main-link">UNISEX</a>
    <a href="../pages/ingresos/ingresos.html" class="sidebar-main-link">INGRESOS</a>
    <a href="../pages/descuentos/descuentos.html" class="sidebar-main-link">DESCUENTOS</a>

    <hr class="sidebar-divider">

    <div class="sidebar-auth-group" id="sidebarAuthGroup">
        <a href="../../auth/login.html" class="sidebar-main-link" id="sidebarLoginLink">INICIAR SESIÓN</a>
        <a href="../../auth/registro.html" class="sidebar-main-link" id="sidebarRegisterLink">REGISTRARSE</a>
    </div>
  </div>
</div>
<!-- Sidebar de Búsqueda (se abre desde el ícono de búsqueda) -->
<div id="sidebar-search" class="sidebar search-sidebar">
  <div class="search-top">
    <div class="search-top-left">
      <button id="search-btn-icon" class="header-icon search-icon" aria-label="Buscar"><i class="fas fa-search"></i></button>
      <input id="search-sidebar-input" type="text" class="search-top-input" placeholder="¿Qué busca?">
    </div>
    <button id="search-close-btn" class="close-btn" aria-label="Cerrar búsqueda">&times;</button>
  </div>

  <hr class="search-divider">

  <div class="sidebar-search-content">
    <div id="search-results" class="search-results">
      <!-- Resultados de búsqueda se insertan aquí -->
    </div>

    <div id="search-suggestions" class="search-suggestions">
      <!-- Sugerencias / productos pequeños (rellenados por JS) -->
    </div>
  </div>
</div>

<!-- Menú desplegable del usuario -->
<div class="user-menu-dropdown" id="user-menu-dropdown">
  <div class="user-menu-header">
    <span class="user-name" id="user-menu-name">Usuario</span>
  </div>
  <div class="user-menu-options">
    <a href="#" id="logout-option" class="user-menu-option">
      <i class="fas fa-sign-out-alt"></i> Cerrar sesión
    </a>
    <a href="../../index.html" id="admin-panel-option" class="user-menu-option" style="display: none;">
      <i class="fas fa-cog"></i> Panel de administración
    </a>
  </div>
  <div class="user-menu-divider"></div>
  <div class="user-menu-history">
    <h4>Últimos productos visitados</h4>
    <div class="history-carousel" id="history-carousel">
      <!-- Los productos se cargarán dinámicamente -->
    </div>
  </div>
</div>

<div class="overlay"></div>

<main class="public-main carrito-main">
    <div class="carrito-container">
    <div class="carrito-header">
        <a href="../home/home.html" class="back-link">
        <i class="fas fa-arrow-left"></i> Seguir comprando
        </a>
        <h1>Mi Carrito</h1>
    </div>

    <div id="carrito-vacio" class="carrito-vacio" style="display: none;">
        <i class="fas fa-shopping-cart empty-cart-icon"></i>
        <h2>Tu carrito está vacío</h2>
        <p>¡Descubre nuestros productos y comienza a comprar!</p>
        <a href="../home/home.html" class="btn-primary">Ir a la tienda</a>
    </div>

    <div id="carrito-contenido" class="carrito-contenido">
        <div class="carrito-items">
        <div class="items-header">
            <h2>Productos (<span id="total-items">0</span>)</h2>
        </div>
        
        <div id="items-list" class="items-list">
        </div>
        </div>

        <div class="carrito-resumen">
        <div class="resumen-card">
            <h2>Resumen de compra</h2>
            
            <div class="resumen-line">
            <span>Productos (<span id="resumen-items">0</span>)</span>
            <span id="resumen-subtotal">$0</span>
            </div>
            
            <div class="resumen-line">
            <span>Envío</span>
            <span id="resumen-envio" class="envio-gratis">GRATIS</span>
            </div>

            <div class="resumen-line descuento-line" id="descuento-line" style="display: none;">
            <span>Descuento</span>
            <span id="resumen-descuento" class="descuento-valor">-$0</span>
            </div>

            <hr>

            <div class="resumen-total">
            <span>Total</span>
            <span id="resumen-total">$0</span>
            </div>

            <button class="btn-finalizar" id="btn-finalizar">
            <i class="fas fa-credit-card"></i> Finalizar compra
            </button>

            <div class="metodos-pago">
            <p class="metodos-titulo">Métodos de pago aceptados:</p>
            <div class="metodos-icons">
                <i class="fab fa-cc-visa"></i>
                <i class="fab fa-cc-mastercard"></i>
                <i class="fab fa-cc-amex"></i>
                <i class="fas fa-money-bill-wave"></i>
            </div>
            </div>

            <div class="beneficios-compra">
            <div class="beneficio-item-small">
                <i class="fas fa-shield-alt"></i>
                <span>Compra segura</span>
            </div>
            <div class="beneficio-item-small">
                <i class="fas fa-undo"></i>
                <span>Devolución gratis</span>
            </div>
            </div>
        </div>
        </div>
    </div>
    </div>
</main>

<footer class="public-footer">
    <div class="footer-container">
    <div class="footer-column">
        <h4>Recirculate</h4>
        <p>Moda circular para un futuro sostenible.</p>
    </div>
    <div class="footer-column">
        <h4>Navegación</h4>
        <ul>
          <li><a href="../home/home.html">Inicio</a></li>
          <li><a href="../pages/remeras/remeras.html">Remeras</a></li>
          <li><a href="../pages/pantalones/pantalones.html">Pantalones</a></li>
          <li><a href="../pages/buzos/buzos.html">Buzos</a></li>
        </ul>
      </div>
    <div class="footer-column">
        <h4>Contacto</h4>
        <ul>
        <li><a href="mailto:info@recirculate.com">info@recirculate.com</a></li>
        <li><a href="tel:+5492615555555">+54 9 261 555-5555</a></li>
        </ul>
    </div>
    <div class="footer-column">
        <h4>Síguenos</h4>
        <div class="social-icons">
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        </div>
    </div>
    </div>
    
    <!-- Línea divisoria -->
    <div class="footer-divider"></div>
    
    <div class="footer-bottom">
    <p>&copy; 2025 Recirculate. Todos los derechos reservados.</p>
    </div>
</footer>

  <!-- Script del menú debe cargarse primero -->
  <script src="../assets/pages.js"></script>
  <!-- Script del menú de usuario -->
  <script src="../assets/user-menu.js"></script>
  <!-- Script del carrito -->
  <script src="carrito.js"></script>
  
  <!-- Inicializar menú de usuario -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Actualizar el icono y tooltip según el estado de autenticación
      const authToken = localStorage.getItem('authToken');
      const userData = localStorage.getItem('userData');
      const userIcon = document.getElementById('user-menu-trigger');
      
      if (authToken && userData) {
        const user = JSON.parse(userData);
        userIcon.setAttribute('data-tooltip', user.nombre.toUpperCase());
        userIcon.innerHTML = '<i class="fas fa-user-check"></i>';
      } else {
        userIcon.setAttribute('data-tooltip', 'INICIAR SESIÓN');
        // Si hace clic y no está logueado, redirigir al login
        userIcon.addEventListener('click', (e) => {
          if (!localStorage.getItem('authToken')) {
            e.preventDefault();
            window.location.href = '../auth/login.html';
          }
        });
      }
    });
  </script>
  
  <script src='https://cdn.jotfor.ms/agent/embedjs/019a2cafb84e7b99aae78f82f10fd7c58f53/embed.js'></script>
</body>
</html>
